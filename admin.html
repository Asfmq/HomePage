<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title id="page-title"></title>
    <meta name="keywords" content="" id="page-keywords">
    <meta name="description" content="" id="page-description">
    <meta name="author" content="" id="page-author">
    <link rel="icon" href="" id="favicon" type="image/x-icon">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="full-screen" content="yes">
    <meta name="browsermode" content="application">
    <meta name="x5-fullscreen" content="true">
    <meta name="x5-page-mode" content="app">
    <meta name="lsvn" content="djEuNS4x">
    
    <!-- 引入外部 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/fontawesome-free5.13.0.css">
    
    <!-- 引入外部 JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

    <script>
        // 显示修改密码模态框
        function showChangePasswordModal() {
            $('#changePasswordModal').modal('show');
        }

        // 修改密码
        async function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                alert('请填写所有密码字段');
                return;
            }

            if (newPassword !== confirmPassword) {
                alert('新密码和确认密码不匹配');
                return;
            }

            try {
                const response = await fetch('/api/change-password', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('adminToken')}`
                    },
                    body: JSON.stringify({
                        currentPassword,
                        newPassword
                    })
                });

                const data = await response.json();
                
                if (response.ok && data.success) {
                    alert(data.message);
                    $('#changePasswordModal').modal('hide');
                    // 3秒后退出登录
                    setTimeout(() => {
                        logout();
                    }, 3000);
                } else {
                    alert(data.message || '密码修改失败');
                }
            } catch (error) {
                console.error('修改密码失败:', error);
                alert('修改密码失败，请稍后重试');
            }
        }

        // 登出函数
        function logout() {
            localStorage.removeItem('adminToken');
            window.location.href = '/login.html';
        }

        let configData = {};

        // 从服务器加载配置
        async function loadConfig() {
            try {
                // 获取 token
                const token = localStorage.getItem('adminToken');
                if (!token) {
                    window.location.href = '/login.html';
                    return;
                }

                const response = await fetch('/config', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (!response.ok) {
                    if (response.status === 401 || response.status === 403) {
                        // 如果是认证问题，重定向到登录页面
                        localStorage.removeItem('adminToken');
                        window.location.href = '/login.html';
                        return;
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const config = await response.json();
                configData = config;

                // 设置页面信息
                document.getElementById('page-title').innerText = config.title;
                document.getElementById('page-keywords').content = config.keywords;
                document.getElementById('page-description').content = config.description;
                document.getElementById('page-author').content = config.author;
                document.getElementById('favicon').href = config.favicon;

                // 设置背景图
                document.body.style.cssText = `
                    background-image: url(${config.backgroundImage});
                    background-size: cover;
                    background-position: center;
                    background-repeat: no-repeat;
                    background-attachment: fixed;
                    min-height: 100vh;
                `;

                // 动态生成导航项
                const navItemsContainer = document.getElementById('nav-items');
                navItemsContainer.innerHTML = ''; // 清空现有内容

                // 添加现有导航项
                config.links.navItems.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.className = "nav-item";
                    li.innerHTML = `<a class="nav-link" href="javascript:void(0)" onclick="showNavDetails(${index}, ${JSON.stringify(item).replace(/"/g, '&quot;')})">${item.name}</a>`;
                    navItemsContainer.appendChild(li);
                });

                // 添加"添加导航"按钮
                const addNavLi = document.createElement('li');
                addNavLi.className = "nav-item";
                addNavLi.innerHTML = `
                    <a class="nav-link" href="javascript:void(0)" onclick="addNewNavItem()">
                        <svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-add"></use>
                        </svg>
                        添加导航
                    </a>
                `;
                navItemsContainer.appendChild(addNavLi);

                // 动态生成分类和链接
                const categoriesContainer = document.getElementById('categories');
                categoriesContainer.innerHTML = ''; // 清空现有内容
                
                config.links.categories.forEach((category, categoryIndex) => {
                    const categoryDiv = document.createElement('ul');
                    categoryDiv.className = "mylist row";
                    
                    // 添加分类标题
                    categoryDiv.innerHTML = `<li class="title">
                        <div class="category-title" onclick="showCategoryDetails(${categoryIndex}, ${JSON.stringify(category).replace(/"/g, '&quot;')})">
                            ${category.icon.startsWith('<svg') ? 
                                category.icon :
                                `<svg class="icon" aria-hidden="true">
                                    <use href="${category.icon}"></use>
                                </svg>`
                            }
                            <span>${category.title}</span>
                        </div>
                    </li>`;
                    
                    // 添加现有链接
                    category.links.forEach(link => {
                        const linkItem = document.createElement('li');
                        linkItem.className = "lylme-3";
                        linkItem.innerHTML = `<a href="javascript:void(0)" onclick="showLinkDetails(${categoryIndex}, ${JSON.stringify(link).replace(/"/g, '&quot;')})">
                            ${link.icon.startsWith('<svg') ? 
                                `${link.icon}` :
                                link.icon.startsWith('#') ?
                                    `<svg class="icon" aria-hidden="true">
                                        <use href="${link.icon}"></use>
                                    </svg>` :
                                    `<img src="${link.icon}" alt="${link.title}">`
                            }
                            <span>${link.name}</span>
                        </a>`;
                        categoryDiv.appendChild(linkItem);
                    });

                    // 添加"添加链接"按钮
                    const addLinkItem = document.createElement('li');
                    addLinkItem.className = "lylme-3 add-link";
                    addLinkItem.innerHTML = `<a href="javascript:void(0)" onclick="addNewLink(${categoryIndex})">
                        <svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-addlink"></use>
                        </svg>
                        <span>添加链接</span>
                    </a>`;
                    categoryDiv.appendChild(addLinkItem);
                    
                    categoriesContainer.appendChild(categoryDiv);
                });

                // 在生成完所有分类后，添加"添加分类"按钮
                const addCategoryDiv = document.createElement('ul');
                addCategoryDiv.className = "mylist row";
                addCategoryDiv.innerHTML = `
                    <li class="title" onclick="addNewCategory()">
                        <svg class="icon" aria-hidden="true">
                            <use href="#icon-add"></use>
                        </svg>
                        <span>添加分类</span>
                    </li>
                `;
                categoriesContainer.appendChild(addCategoryDiv);

                // 设置版权和备案信息
                document.getElementById('copyright').innerHTML = `
                    <div class="text-center">
                        <span class="copyright-wrapper d-inline-block" onclick="showCopyrightDetails(event)">
                            ${config.copyright.show ? 
                                `Copyright ©${config.copyright.text} <span class="copyright-link">${config.copyright.target}</span>. All Rights Reserved.
                                ${config.copyright.showRecord ? 
                                    `<br><span class="record-link">${config.copyright.record}</span>` 
                                    : ''
                                }` 
                                : '<span class="text-muted">点击开启版权信息显示</span>'
                            }
                        </span>
                    </div>
                `;

                // 生成搜索引擎列表
                const searchTypeContainer = document.getElementById('chso');
                searchTypeContainer.innerHTML = ''; // 清空现有内容

                // 添加现有搜索引擎
                config.links.searchEngines.forEach((engine, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <input hidden="" type="radio" name="type" id="${engine.name}" value="${engine.url}" data-placeholder="${engine.placeholder}">
                        <label for="${engine.name}" onclick="showEngineDetails(${index}, ${JSON.stringify(engine).replace(/"/g, '&quot;')})" style="font-weight:600">
                            ${engine.icon.startsWith('<svg') ? 
                                `${engine.icon}` :
                                engine.icon.startsWith('#') ?
                                    `<svg class="icon" aria-hidden="true">
                                        <use href="${engine.icon}"></use>
                                    </svg>` :
                                    `<img src="${engine.icon}" alt="${engine.title}">`
                            }
                            <span style="color:#0c498c">${engine.name}</span>
                        </label>
                    `;
                    searchTypeContainer.appendChild(li);
                });

                // 添加"添加搜索引擎"按钮
                const addEngineLi = document.createElement('li');
                addEngineLi.className = "add-engine";
                addEngineLi.innerHTML = `
                    <input hidden="" type="radio" name="type" id="add-engine">
                    <label for="add-engine" onclick="addNewEngine()" style="font-weight:600">
                        <svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-add"></use>
                        </svg>
                        <span style="color:#0c498c">添加搜索引擎</span>
                    </label>
                `;
                searchTypeContainer.appendChild(addEngineLi);

                // 在所有列表生成完成后初始化 Sortable
                setTimeout(() => {
                    initSortable();
                }, 100);

            } catch (error) {
                console.error('加载配置失败:', error);
                alert('加载配置失败，请重试');
            }
        }

        // 添加全局 fetch 拦截器，为所有请求添加 token
        document.addEventListener('DOMContentLoaded', function() {
            const originalFetch = window.fetch;
            window.fetch = function() {
                let [resource, config] = arguments;
                
                const token = localStorage.getItem('adminToken');
                if (token) {
                    if (!config) {
                        config = {};
                    }
                    if (!config.headers) {
                        config.headers = {};
                    }
                    config.headers['Authorization'] = `Bearer ${token}`;
                }
                
                return originalFetch(resource, config);
            };

            // 初始化页面
            loadConfig();
            initSortable();
        });
    </script>

</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarsExample05">
            <svg class="icon" width="200" height="200"><use xlink:href="#icon-menus"></use></svg>
            <span><svg class="bi bi-x" fill="currentColor" id="x"><use xlink:href="#icon-closes"></use></svg></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarsExample05">
            <ul class="navbar-nav mr-auto" id="nav-items"></ul>
            <button class="btn nav-link text-white" style="border: none; background: none;" onclick="showSiteInfo()">
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#icon-setting"></use>
                </svg>
                网站信息
            </button>
            <div class="nav-item dropdown">
                <button class="btn nav-link text-white" style="border: none; background: none;" type="button" id="adminDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <svg class="icon" aria-hidden="true">
                        <use xlink:href="#icon-admin"></use>
                    </svg>
                    管理员
                </button>
                <div class="dropdown-menu" aria-labelledby="adminDropdown">
                    <a class="dropdown-item" href="#" onclick="showChangePasswordModal()">
                        修改密码
                    </a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#" onclick="logout()">
                        退出登录
                    </a>
                </div>
            </div>
            <!-- <div id="he-plugin-simple"></div> -->
        </div>		
    </nav>

    <main class="container" style="margin-top:10vh;">
        <div id="main">
            <div id="show_time"></div>  
            <div id="show_date"></div>  
        </div>

        <!-- 搜索框 -->
        <div id="search" class="s-search s-curren">
            <div id="search-list" class="hide-type-list">
                <div class="search-group group-a">
                    <div class="search-box">
                        <div id="search-lylme">
                            <form action="https://cn.bing.com/search?q=" method="get" target="_blank" id="super-search-fm">
                                <div id="checke-so" onclick="lylme()">
                                    <svg class="lylme" aria-hidden="true"><use xlink:href="#icon-bing"></use></svg>
                                    <svg class="sw" id="lylme-up" style="display:inline" aria-hidden="true"><use xlink:href="#icon-up"></use></svg>
                                    <svg class="sw" id="lylme-down" style="display:none" aria-hidden="true"><use xlink:href="#icon-down"></use></svg>
                                </div>
                                <input type="text" id="search-text" placeholder="微软应搜索" style="outline:0" autocomplete="off">
                                <button class="submit" id="search-submit" type="submit">
                                    <svg style="width: 22px; height: 22px; margin: 0 20px; color: #fff;" class="icon" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 搜索类型选择 -->
            <ul class="search-type" id="chso"></ul>

            <div class="set-check hidden-xs">
                <input type="checkbox" id="set-search-blank" class="bubble-3" autocomplete="off">
            </div>
            
            <ul id="word" style="display: none;"></ul>
        </div>

        <!-- 动态生成分类 -->
        <ul class="mylist row" id="categories"></ul>
    </main>

    <!-- 回顶部 -->
    <div style="display:none;" class="back-to" id="toolBackTop">
        <a title="回顶部" onclick="window.scrollTo(0,0);return false;" href="#top" class="back-top"></a>
    </div>

    <!-- 底部信息 -->
    <footer class="mt-5 mb-3 footer text-muted text-center">
        <p id="copyright"></p>
    </footer>

    <!-- 引入自定义 JS -->
    <script src="./js/script.js"></script>
    <script src="./js/svg.js"></script>
    <script src="./js/admin.js"></script>

    <!-- 模态框 -->
    <div class="modal fade" id="addLinkModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">添加新链接</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="addLinkForm">
                        <input type="hidden" id="addLinkCategoryIndex">
                        <div class="form-group">
                            <label>链接名称</label>
                            <input type="text" class="form-control" id="linkName">
                        </div>
                        <div class="form-group">
                            <label>链接地址</label>
                            <div class="input-group">
                                <input type="url" class="form-control" id="linkUrl">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary" type="button" onclick="autoFetchLinkInfo()">
                                        <svg class="icon" aria-hidden="true" style="width: 16px; height: 16px;">
                                            <use xlink:href="#icon-sousuo"></use>
                                        </svg>
                                        <span>自动获取</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>图标</label>
                            <input type="text" class="form-control" id="linkIcon">
                            <small class="form-text text-muted">
                                支持
                                <a href="https://www.iconfont.cn/" target="_blank" class="icon-link">SVG</a>
                                代码
                            </small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="saveNewLink()">保存</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addEngineModal" tabindex="-1" aria-labelledby="addEngineModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addEngineModalLabel">添加搜索引擎</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="addEngineForm">
                        <div class="form-group">
                            <label for="engineName">搜索引擎名称</label>
                            <input type="text" class="form-control" id="engineName" required>
                        </div>
                        <div class="form-group">
                            <label for="engineUrl">搜索URL</label>
                            <input type="url" class="form-control" id="engineUrl" required>
                            <small class="form-text text-muted">使用 %s 代替搜索键词，如：https://www.google.com/search?q=%s</small>
                        </div>
                        <div class="form-group">
                            <label for="engineIcon">图标代码</label>
                            <input type="text" class="form-control" id="engineIcon" required>
                        </div>
                        <div class="form-group">
                            <label for="enginePlaceholder">搜索框提示文字</label>
                            <input type="text" class="form-control" id="enginePlaceholder">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveEngine">保存</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addNavModal" tabindex="-1" aria-labelledby="addNavModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addNavModalLabel">添加导航项</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="addNavForm">
                        <div class="form-group">
                            <label for="navName">导航名称</label>
                            <input type="text" class="form-control" id="navName" required>
                        </div>
                        <div class="form-group">
                            <label for="navUrl">链接地址</label>
                            <input type="url" class="form-control" id="navUrl" required>
                        </div>
                        <div class="form-group">
                            <label for="navId">ID (可选)</label>
                            <input type="text" class="form-control" id="navId">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveNav">保存</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="linkDetailsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">链接详情</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="linkDetailsForm">
                        <input type="hidden" id="linkDetailsCategoryIndex">
                        <input type="hidden" id="linkDetailsIndex">
                        <div class="form-group">
                            <label>链接名称</label>
                            <input type="text" class="form-control" id="linkDetailsName">
                        </div>
                        <div class="form-group">
                            <label>链接地址</label>
                            <div class="input-group">
                                <input type="url" class="form-control" id="linkDetailsUrl">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary" type="button" onclick="autoFetchLinkInfo()">
                                        <svg class="icon" aria-hidden="true" style="width: 16px; height: 16px;">
                                            <use xlink:href="#icon-sousuo"></use>
                                        </svg>
                                        <span>自动获取</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>图标</label>
                            <input type="text" class="form-control" id="linkDetailsIcon">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" onclick="deleteCurrentLink()">删除</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="saveCurrentLink()">保存更改</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="engineDetailsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">搜索引擎详情</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="engineDetailsForm">
                        <input type="hidden" id="engineDetailsIndex">
                        <div class="form-group">
                            <label>搜索引擎名称</label>
                            <input type="text" class="form-control" id="engineDetailsName">
                        </div>
                        <div class="form-group">
                            <label>搜索URL</label>
                            <input type="url" class="form-control" id="engineDetailsUrl">
                        </div>
                        <div class="form-group">
                            <label>图标代码</label>
                            <input type="text" class="form-control" id="engineDetailsIcon">
                        </div>
                        <div class="form-group">
                            <label>搜索框提示文字</label>
                            <input type="text" class="form-control" id="engineDetailsPlaceholder">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" onclick="deleteCurrentEngine()">删除</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="saveCurrentEngine()">保存更改</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="navDetailsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">导航项详情</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="navDetailsForm">
                        <input type="hidden" id="navDetailsIndex">
                        <div class="form-group">
                            <label>导航名称</label>
                            <input type="text" class="form-control" id="navDetailsName">
                        </div>
                        <div class="form-group">
                            <label>链接地址</label>
                            <input type="url" class="form-control" id="navDetailsUrl">
                        </div>
                        <div class="form-group">
                            <label>ID</label>
                            <input type="text" class="form-control" id="navDetailsId">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" onclick="deleteCurrentNav()">删除</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="saveCurrentNav()">保存更改</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="categoryDetailsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">分类详情</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="categoryDetailsForm">
                        <input type="hidden" id="categoryDetailsIndex">
                        <div class="form-group">
                            <label>分类名称</label>
                            <input type="text" class="form-control" id="categoryDetailsTitle">
                        </div>
                        <div class="form-group">
                            <label>图标代码</label>
                            <input type="text" class="form-control" id="categoryDetailsIcon">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" onclick="deleteCurrentCategory()">删除</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="saveCurrentCategory()">保存更改</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addCategoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">添加新分类</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="addCategoryForm">
                        <div class="form-group">
                            <label>分类名称</label>
                            <input type="text" class="form-control" id="newCategoryTitle" required>
                        </div>
                        <div class="form-group">
                            <label>图标代码</label>
                            <input type="text" class="form-control" id="newCategoryIcon" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="saveNewCategory()">保存</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="copyrightModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">版权设置</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="copyrightForm">
                        <div class="form-group">
                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input" id="showCopyright">
                                <label class="custom-control-label" for="showCopyright">显示版权信息</label>
                            </div>
                        </div>
                        <div id="copyrightFields">
                            <div class="form-group">
                                <label>版权文本</label>
                                <input type="text" class="form-control" id="copyrightText">
                            </div>
                            <div class="form-group">
                                <label>版权链接目标</label>
                                <input type="text" class="form-control" id="copyrightTarget">
                            </div>
                            <div class="form-group">
                                <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="showRecord">
                                    <label class="custom-control-label" for="showRecord">显示备案信息</label>
                                </div>
                            </div>
                            <div id="recordFields">
                                <div class="form-group">
                                    <label>备案号</label>
                                    <input type="text" class="form-control" id="copyrightRecord">
                                </div>
                                <div class="form-group">
                                    <label>备案链接</label>
                                    <input type="url" class="form-control" id="copyrightRecordUrl">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="saveCopyrightSettings()">保存</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="siteInfoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">网站信息设置</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="siteInfoForm">
                        <div class="form-group">
                            <label>网站标题</label>
                            <input type="text" class="form-control" id="siteTitle">
                        </div>
                        <div class="form-group">
                            <label>关键词</label>
                            <input type="text" class="form-control" id="siteKeywords">
                        </div>
                        <div class="form-group">
                            <label>网站描述</label>
                            <textarea class="form-control" id="siteDescription" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>作者</label>
                            <input type="text" class="form-control" id="siteAuthor">
                        </div>
                        <div class="form-group">
                            <label>网站图标</label>
                            <input type="text" class="form-control" id="siteFavicon">
                        </div>
                        <div class="form-group">
                            <label>背景图片</label>
                            <input type="text" class="form-control" id="siteBackground">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="saveSiteInfo()">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加修改密码的模态框 -->
    <div class="modal fade" id="changePasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">修改密码</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="changePasswordForm">
                        <div class="form-group">
                            <label>当前密码</label>
                            <input type="password" class="form-control" id="currentPassword" required>
                        </div>
                        <div class="form-group">
                            <label>新密码</label>
                            <input type="password" class="form-control" id="newPassword" required>
                        </div>
                        <div class="form-group">
                            <label>确认新密码</label>
                            <input type="password" class="form-control" id="confirmPassword" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="changePassword()">保存</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
